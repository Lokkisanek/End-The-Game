<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>0x77_RED_ROOM_V3</title>
    <style>
        body {
            background-color: #000;
            color: #cc0000;
            font-family: 'Courier New', Courier, monospace;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        /* --- FÁZE 1: VSTUPNÍ BRÁNA --- */
        #gate-screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, #1a0000 0%, #000 90%);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100;
        }
        
        .inputs-container {
            display: flex; gap: 10px; margin: 30px 0;
        }
        
        .code-input {
            background: #111; border: 1px solid red; color: white;
            font-size: 1.5em; width: 100px; padding: 10px; text-align: center;
            text-transform: uppercase; letter-spacing: 2px;
        }

        .enter-btn {
            background: #500; color: white; border: none; padding: 15px 40px;
            font-size: 1.2em; cursor: pointer; letter-spacing: 3px;
            transition: 0.3s;
        }
        .enter-btn:hover { background: red; color: black; }
        
        .error { color: red; margin-top: 20px; visibility: hidden; }


        /* --- FÁZE 2: RED ROOM --- */
        #room-screen {
            display: none; /* Skryto na začátku */
            height: 100vh; flex-direction: column;
        }

        .main-area {
            flex: 3; display: flex; border-bottom: 4px solid #300;
        }

        /* Video Feed */
        .video-feed {
            flex: 3;
            background: #050000;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .scanlines {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: repeating-linear-gradient(0deg, rgba(0,0,0,0.5), rgba(0,0,0,0.5) 1px, transparent 2px);
            pointer-events: none; z-index: 5;
        }

        .victim-placeholder {
            position: relative;
            width: 100%;
            height: 100%;
            background: url('fx/redroom.jpeg') center/cover no-repeat;
            border: 6px solid rgba(255, 0, 0, 0.35);
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.4), inset 0 0 40px rgba(0, 0, 0, 0.9);
            animation: camPulse 2.8s ease-in-out infinite;
            filter: saturate(0.9) contrast(1.05);
        }

        .victim-placeholder::after {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle, rgba(0, 0, 0, 0) 25%, rgba(0, 0, 0, 0.7));
            mix-blend-mode: multiply;
            animation: blackPulse 4s ease-in-out infinite;
            pointer-events: none;
        }

        .victim-placeholder--deceased {
            filter: grayscale(0.95) brightness(0.4);
            animation: none;
        }
        
        .live-indicator {
            position: absolute; top: 20px; left: 20px;
            background: red; color: white; padding: 5px 10px; font-weight: bold;
            animation: blink 1s infinite; z-index: 10;
        }

        /* VIP Chat */
        .chat-sidebar {
            flex: 1; background: #0a0a0a; border-left: 2px solid #333;
            display: flex; flex-direction: column;
        }
        
        .chat-header {
            background: #200; padding: 10px; text-align: center; color: red; font-weight: bold;
            border-bottom: 1px solid red;
        }

        #chat-content {
            flex: 1; overflow-y: auto; padding: 10px; font-family: Arial, sans-serif; font-size: 0.9em;
        }

        .msg { margin-bottom: 8px; line-height: 1.4; }
        .vip { color: gold; font-weight: bold; }
        .sys { color: #f44; font-style: italic; }
        .txt { color: #aaa; }

        /* Ovládací Panel */
        .control-panel {
            height: 250px; background: #111; display: flex;
            align-items: center; justify-content: center; flex-direction: column;
        }

        #action-btn {
            background: transparent; border: 3px solid #00ff00; color: #00ff00;
            padding: 25px 60px; font-size: 2em; font-family: 'Impact', sans-serif;
            text-transform: uppercase; cursor: pointer; letter-spacing: 2px;
            box-shadow: 0 0 15px #00ff00; transition: 0.3s;
        }

        #action-btn:hover {
            background: #00ff00; color: black; box-shadow: 0 0 40px #00ff00;
        }

        .btn-desc {
            color: gray; margin-top: 15px; font-size: 0.8em; text-align: center;
        }

        @keyframes breathe { 0% { opacity:0.6; transform: scale(1); } 50% { opacity:1; transform: scale(1.02); } 100% { opacity:0.6; transform: scale(1); } }
        @keyframes camPulse { 0% { transform: scale(0.995); box-shadow: 0 0 20px rgba(255,0,0,0.2);} 50% { transform: scale(1.01); box-shadow: 0 0 50px rgba(255,0,0,0.55);} 100% { transform: scale(0.995); box-shadow: 0 0 20px rgba(255,0,0,0.2);} }
        @keyframes blackPulse { 0% { opacity: 0.25; } 50% { opacity: 0.65; } 100% { opacity: 0.25; } }
        @keyframes blink { 50% { opacity: 0; } }

        /* Ending Overlay */
        #whiteout {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: white; z-index: 200; opacity: 0; pointer-events: none;
            transition: opacity 4s ease-in;
        }
    </style>
</head>
<body>

    <div id="gate-screen">
        <h1 style="text-shadow: 0 0 10px red;">SECURE GATEWAY</h1>
        <p>Zadejte 5 fragmentů přístupového klíče.</p>
        
        <div class="inputs-container">
            <input type="text" class="code-input" id="c1" maxlength="5">
            <input type="text" class="code-input" id="c2" maxlength="5">
            <input type="text" class="code-input" id="c3" maxlength="5">
            <input type="text" class="code-input" id="c4" maxlength="5">
            <input type="text" class="code-input" id="c5" maxlength="5">
        </div>
        
        <button class="enter-btn" onclick="checkCodes()">DEŠIFROVAT</button>
        <div class="error" id="err-msg">PŘÍSTUP ZAMÍTNUT.</div>
    </div>

    <div id="room-screen">
        <div class="main-area">
            <div class="video-feed">
                <div class="scanlines"></div>
                <div class="live-indicator">● LIVE</div>
                
                <div class="victim-placeholder" id="victim-visual"></div>
                
                <div style="position: absolute; bottom: 20px; color: white; text-shadow: 0 0 5px black;">
                    CAM_01: ISOLATION ROOM
                </div>
            </div>

            <div class="chat-sidebar">
                <div class="chat-header">VIP LOUNGE (8 Users)</div>
                <div id="chat-content">
                    </div>
            </div>
        </div>

        <div class="control-panel">
            <div style="color: #00ff00; margin-bottom: 20px; border: 1px solid #00ff00; padding: 5px;">
                SYSTEM STATUS: <span style="animation: blink 1s infinite;">WAITING FOR INPUT</span>
            </div>
            
            <button id="action-btn" onclick="executeRelease()">RELEASE LOCKS</button>
            
            <div class="btn-desc">
                POZOR: Funkce "RELEASE" okamžitě ukončí bezpečnostní protokol a otevře celu.<br>
                Používejte pouze pro přesun subjektu.
            </div>
        </div>
    </div>

    <div id="whiteout"></div>

<script>
    // --- 1. NASTAVENÍ KÓDŮ ---
    // Zde nastav kódy, které hráč posbíral ve hře
    const CODES = ["ALFA", "BETA", "GAMMA", "DELTA", "OMEGA"];

    const redRoomAudio = {
        started: false,
        layers: []
    };

    function startRedRoomAudio() {
        if (redRoomAudio.started) return;
        const cry = new Audio('fx/redroom-cry.mp3');
        cry.loop = true;
        cry.volume = 0.65;
        const ambience = new Audio('fx/redroom-ambiance.mp3');
        ambience.loop = true;
        ambience.volume = 0.45;
        redRoomAudio.layers = [cry, ambience];
        redRoomAudio.layers.forEach((layer) => {
            layer.play().catch(() => {});
        });
        redRoomAudio.started = true;
    }

    function stopRedRoomAudio() {
        redRoomAudio.layers.forEach((layer) => {
            try {
                layer.pause();
                layer.currentTime = 0;
            } catch (err) {}
        });
        redRoomAudio.layers = [];
        redRoomAudio.started = false;
    }

    function checkCodes() {
        const i1 = document.getElementById('c1').value.toUpperCase();
        const i2 = document.getElementById('c2').value.toUpperCase();
        const i3 = document.getElementById('c3').value.toUpperCase();
        const i4 = document.getElementById('c4').value.toUpperCase();
        const i5 = document.getElementById('c5').value.toUpperCase();

        if (i1 === CODES[0] && i2 === CODES[1] && i3 === CODES[2] && i4 === CODES[3] && i5 === CODES[4]) {
            // Úspěch
            document.getElementById('gate-screen').style.display = 'none';
            document.getElementById('room-screen').style.display = 'flex';
            startRedRoomAudio();
            startChat();
        } else {
            // Chyba
            document.getElementById('err-msg').style.visibility = 'visible';
        }
    }

    // --- 2. GENERÁTOR CHATU (Bez Unknowna) ---
    // Jen VIP, kteří sázejí a komentují
    const vips = ["SickBoy", "The_Collector", "Dr_Pain", "Watcher_X", "Guest_666", "Richie_Rich"];
    const comments = [
        "Nuda. Probuďte ji.",
        "Kolik stojí minuta?",
        "Dneska vypadá nějak klidně.",
        "Doufám, že použijete skalpel.",
        "Zaplatil jsem za krev, ne za spaní.",
        "Pěkné tetování. To chci jako suvenýr.",
        "Admin? Zvyšte hlasitost.",
        "Mám vsazeno na 10 minut. Dělejte."
    ];

    function startChat() {
        const chatBox = document.getElementById('chat-content');
        
        // Úvodní systémová zpráva
        addMsg('SYSTEM', 'Nový uživatel připojen (GUEST_ADMIN).', 'sys');

        // Smyčka generující zprávy
        setInterval(() => {
            if(Math.random() > 0.6) { // Náhodný interval
                const user = vips[Math.floor(Math.random() * vips.length)];
                const text = comments[Math.floor(Math.random() * comments.length)];
                addMsg(user, text, 'vip');
            }
        }, 3000);
    }

    function addMsg(user, text, type) {
        const chatBox = document.getElementById('chat-content');
        const div = document.createElement('div');
        div.className = 'msg';
        
        if (type === 'sys') {
            div.innerHTML = `<span class="sys">[SYSTEM]:</span> <span class="txt">${text}</span>`;
        } else {
            div.innerHTML = `<span class="vip">[${user}]:</span> <span class="txt">${text}</span>`;
        }
        
        chatBox.appendChild(div);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    // --- 3. EXEKUCE (Konec hry) ---
    function executeRelease() {
        const btn = document.getElementById('action-btn');
        const victim = document.getElementById('victim-visual');
        const overlay = document.getElementById('whiteout');

        // Změna tlačítka na červené
        btn.disabled = true;
        btn.style.borderColor = "red";
        btn.style.color = "red";
        btn.style.boxShadow = "none";
        btn.innerText = "GAS RELEASED";

        // Reakce systému
        addMsg('SYSTEM', 'PŘÍKAZ PŘIJAT: UVOLNĚNÍ ZÁMKŮ ZAMÍTNUTO.', 'sys');
        setTimeout(() => addMsg('SYSTEM', 'BEZPEČNOSTNÍ PROTOKOL: AKTIVACE PLYNU.', 'sys'), 1000);

        // Reakce VIP v chatu (Jsou nadšení nebo lhostejní - to je ten horor)
        setTimeout(() => addMsg('Dr_Pain', 'Oho! Plyn? Klasika.', 'vip'), 2000);
        setTimeout(() => addMsg('SickBoy', 'Konečně akce!', 'vip'), 3000);
        setTimeout(() => addMsg('Watcher_X', 'Dívejte se, jak se dusí.', 'vip'), 4500);

        // Vizuální smrt Mayi
        setTimeout(() => {
            victim.style.transform = "rotate(6deg) scale(0.92)";
            victim.classList.add('victim-placeholder--deceased');
        }, 6000);

        setTimeout(() => addMsg('SYSTEM', 'VITAL SIGNS: 0. SUBJECT DECEASED.', 'sys'), 7000);
        setTimeout(() => addMsg('The_Collector', 'Dobrá show. Kdo je další?', 'vip'), 9000);

        // Konec - Bílá obrazovka
        setTimeout(() => {
            overlay.style.opacity = 1;
        }, 11000);

        // Game Over Text
        setTimeout(() => {
            stopRedRoomAudio();
            document.body.innerHTML = `
                <div style="height:100vh; display:flex; justify-content:center; align-items:center; background:white; flex-direction:column; color:black; font-family:sans-serif;">
                    <h1 style="font-size:4em; margin:0;">GAME OVER</h1>
                    <p style="font-size:1.2em; color:#555;">Myslel jsi, že otevíráš dveře.</p>
                    <p style="font-size:1.2em; color:#555;">Ale v Red Roomu neexistují šťastné konce.</p>
                </div>
            `;
        }, 15000);
    }
</script>

</body>
</html>